<!DOCTYPE html>
<html>
<head>
<title> setMarker </title>
<meta charset="utf-8">
    <style>
    
        #map-canvas {
            width: 1000px;
            height: 1000px;
        }
    </style>
    <script>
    window.onload = function() {
        var xmlhttp = new XMLHttpRequest();
        var xmlhttp1 = new XMLHttpRequest();
        var url = '20121107.json';
        
        // Change bus route here
        var urlBus = 'https://data.dublinked.ie/cgi-bin/rtpi/routeinformation?routeid=46a&operator=bac';
        var x;
        var y;
        var busStop;
        var map;

        // GPS Data
        xmlhttp.onreadystatechange = function() {
            if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
                x = JSON.parse(xmlhttp.responseText);
                console.log(x);
                addmarker();
            }
        };
        xmlhttp.open("GET", url, true);
        xmlhttp.send();
        
        // Bus Stop Data
         xmlhttp1.onreadystatechange = function() {
            if (xmlhttp1.readyState == 4 && xmlhttp1.status == 200) {
                var temp = JSON.parse(xmlhttp1.responseText);
                y = temp['results'];
                console.log(y[0]['stops'][0]);
                addBusMarker();
                
            }
        };
        xmlhttp1.open("GET", urlBus, true);
        xmlhttp1.send();
        
        

        function initmap() {
            var location = new google.maps.LatLng(53.318375, -6.230936);

            var mapOptions = {
                zoom: 15,
                center: location,
                streetViewControl: false,
                scaleControl: true,
                zoomControl: true,
                zoomControlOptions: {
                    position: google.maps.ControlPosition.TOP_CENTER,
                    style: google.maps.ZoomControlStyle.LARGE
                },
                draggableCursor:'crosshair'
            };
            map = new google.maps.Map(document.getElementById('map-canvas'),mapOptions);

        }
        
        
        //GPS marker
        function addmarker() {
             
            //marker
        
            for(i=0; i<x.length; i++) {
                var marker = new google.maps.Marker({
                position: new google.maps.LatLng(x[i]['Lat'], x[i]['Lon']),
                map: map,
                // show on marker 'order / at Stop'
                label: i + '/'+x[i]['AtStop'] + ''
                });
            }
            console.log('end');
    
        };
        
        //bus stop marker
        function addBusMarker() {
            //marker
            
            //Direction 1
            for(j=0; j<y[0]['stops'].length; j++) {
                var marker = new google.maps.Marker({
                position: new google.maps.LatLng(y[0]['stops'][j]['latitude'], y[0]['stops'][j]['longitude']),
                map: map,
                icon: 'http://maps.google.com/mapfiles/ms/icons/green-dot.png',
                // show on marker 'order / at Stop'
                label: y[0]['stops'][j]['stopid'] + ''
                });
            }
            
            // Direction 2
            for(j=0; j<y[1]['stops'].length; j++) {
                var marker = new google.maps.Marker({
                position: new google.maps.LatLng(y[1]['stops'][j]['latitude'], y[1]['stops'][j]['longitude']),
                map: map,
                icon: 'http://maps.google.com/mapfiles/ms/icons/blue-dot.png',
                // show on marker 'order / at Stop'
                label: y[1]['stops'][j]['stopid'] + ''
                });
            }
            
        };
        
        //call funvction map and marker
        initmap();
        
<<<<<<< HEAD
=======
        
        
>>>>>>> a8c6a6b35e88a2000e4ee26d5685a432f6a05059
    }
    
    </script>

    
</head>


<body>
    
    <div id='map-canvas'></div>
    <input id='btn' type="button" value="click"/>

    
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCx5JNQOaLel0WxSrU8VOFgwKJLMzn-ELM" type="text/javascript"></script>

    
</body>
</html>